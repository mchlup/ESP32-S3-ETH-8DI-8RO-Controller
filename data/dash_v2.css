/* Dashboard V2 – sekce dle aktivních funkcí (ventily, teploty) */

.ioTile {
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 10px;
  padding: 12px;
  border: 1px solid var(--line);
  border-radius: 12px;
  background: rgba(255,255,255,.02);
}

.ioTile .ioName { font-weight: 700; }
.ioTile .ioSub { font-size: 12px; color: var(--muted); margin-top: 4px; }

.ioRight {
  display: grid;
  align-content: center;
  justify-items: center;
  gap: 8px;
}

.dial {
  width: 48px;
  height: 48px;
  border-radius: 999px;
  background: conic-gradient(
    var(--accent) 0%,
    var(--accent) var(--p),
    rgba(255,255,255,.10) var(--p),
    rgba(255,255,255,.10) 100%
  );
  display: grid;
  place-items: center;
  position: relative;
}

.dial::after {
  content: "";
  width: 36px;
  height: 36px;
  border-radius: 999px;
  background: var(--panel);
  border: 1px solid var(--line);
  position: absolute;
  inset: 6px;
}

.dial .dialTxt{
  position: relative;
  z-index: 1;
  font-size: 12px;
  font-weight: 800;
}

.ioTile.moving .dial {
  animation: dialPulse 1s ease-in-out infinite;
}

@keyframes dialPulse {
  0% { transform: scale(1.00); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1.00); }
}

.tempValue {
  font-size: 18px;
  font-weight: 800;
}

.akuTank {
  display: grid;
  gap: 8px;
}
.akuRow {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 10px;
  border: 1px solid var(--line);
  border-radius: 10px;
  background: rgba(255,255,255,.02);
}
.akuStatus {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 13px;
  color: var(--muted);
}
.akuDot {
  width: 10px;
  height: 10px;
  border-radius: 999px;
  background: var(--muted);
}
.akuDot.on { background: var(--good); }

/* Ekviterm – miniaturní graf */
.ioTile.eqCurveTile{ grid-column: 1 / -1; }
.ioTile.eqCurveTile .ioRight{ justify-items: stretch; width:100%; }
.eqMiniCurve{
  width: 100%;
  max-width: 340px;
  height: 120px;
  border-radius: 10px;
  background: rgba(255,255,255,.02);
  border: 1px solid var(--line);
}

/* Schéma topného systému (SVG) */
.schemaWrap{ width: 100%; }
.schemaWrap svg{
  width: 100%;
  height: auto;
  max-height: 380px;
  display: block;
}
.schemaWrap .pipe{
  fill: none;
  stroke: rgba(255,255,255,.18);
  stroke-width: 5;
  stroke-linecap: round;
  stroke-linejoin: round;
}
.schemaWrap .pipe.supply{ stroke: rgba(255,107,125,.35); }
.schemaWrap .pipe.return{ stroke: rgba(107,229,255,.30); }
.schemaWrap .pipe.active{
  stroke-opacity: 1;
  stroke-dasharray: 10 10;
  animation: schemaFlow 1.2s linear infinite;
}
.schemaWrap .pipe.supply.active{ stroke: var(--bad); }
.schemaWrap .pipe.return.active{ stroke: var(--accent); }
.schemaWrap .comp{
  fill: rgba(255,255,255,.02);
  stroke: var(--line);
  stroke-width: 2;
}
.schemaWrap .comp.on{ stroke: rgba(78,229,154,.65); }
.schemaWrap .label{ fill: var(--text); font: 700 16px system-ui, -apple-system, Segoe UI, Roboto, Arial; }
.schemaWrap .sublabel{ fill: var(--muted); font: 600 12px system-ui, -apple-system, Segoe UI, Roboto, Arial; }
.schemaWrap .valve{ fill: rgba(255,255,255,.02); stroke: rgba(255,255,255,.25); stroke-width: 2; }
.schemaWrap .valve.moving{ stroke: var(--warn); animation: valvePulse 1s ease-in-out infinite; }
.schemaWrap .hidden{ display:none; }

@keyframes schemaFlow{ to { stroke-dashoffset: -40; } }
@keyframes valvePulse{ 0%{opacity:.85} 50%{opacity:1} 100%{opacity:.85} }


/* Dashboard layout – Ekviterm jako hlavní widget */
#page-dash .dashLayout{
  display:grid;
  grid-template-columns: 1.55fr .85fr;
  grid-template-areas:
    "schema schema"
    "equitherm modes"
    "aku reasons"
    "valvemix reasons"
    "tuv recirc"
    "relays inputs"
    "valves temps";
  gap: 14px;
}

/* Při skrytí karet (display:none) se layout automaticky zabalí */
#page-dash #cardEquitherm{ grid-area: equitherm; }
#page-dash #cardSchema{ grid-area: schema; }
#page-dash #cardAku{ grid-area: aku; }
#page-dash #cardValveMix{ grid-area: valvemix; }
#page-dash #cardTuv{ grid-area: tuv; }
#page-dash #cardRecirc{ grid-area: recirc; }
#page-dash #cardReasons{ grid-area: reasons; }
#page-dash #cardModes{ grid-area: modes; }
#page-dash #cardRelays{ grid-area: relays; }
#page-dash #cardInputs{ grid-area: inputs; }
#page-dash #cardValves{ grid-area: valves; }
#page-dash #cardTemps{ grid-area: temps; }

/* Režimy – pole pod sebou (užší karta) */
#page-dash .row.stack{
  flex-direction: column;
  align-items: stretch;
}
#page-dash .row.stack .field{ width: 100%; }
#page-dash .row.stack .btnRow{ justify-content: flex-start; }

/* Ekviterm dlaždice – kompaktnější a vyvážené */
#page-dash #eqDashGrid{
  grid-template-columns: repeat(3, minmax(0,1fr));
  gap: 10px;
}
#page-dash #eqDashGrid .ioTile{ padding: 10px; }

/* Ekviterm – větší graf + popisky */
#page-dash .eqMiniCurve{
  max-width: 520px;
  height: 160px;
}

/* Responsive */
@media (max-width: 1100px){
  #page-dash .dashLayout{
    grid-template-columns: 1fr;
    grid-template-areas:
      "schema"
      "equitherm"
      "aku"
      "valvemix"
      "tuv"
      "recirc"
      "reasons"
      "modes"
      "relays"
      "inputs"
      "valves"
      "temps";
  }
  #page-dash .eqMiniCurve{ max-width: 100%; }
}
