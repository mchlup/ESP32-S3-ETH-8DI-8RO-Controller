<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ESP Heat Controller</title>
  <link rel="stylesheet" href="/css/base.css" />
  <link rel="stylesheet" href="/css/layout.css" />
  <link rel="stylesheet" href="/css/components.css" />
  <link rel="stylesheet" href="/css/pages.css" />
  <link rel="stylesheet" href="/css/dash.css" />
  <link rel="stylesheet" href="/css/schematic.css" />
</head>
<body>
  <div id="app" class="app">
    <aside class="side" id="sidebar">
      <div class="brand">
        <div class="logo" aria-hidden="true">‚ü°</div>
        <div class="brandTxt">
          <div class="brandTitle">Heat Controller</div>
          <div class="brandSub" id="brandSub">‚Äî</div>
        </div>
        <button class="iconBtn" id="btnCollapse" type="button" aria-label="Skr√Ωt menu">‚ü®‚ü©</button>
      </div>

      <nav class="nav" id="nav" aria-label="Navigace">
        <div class="navGroup">
          <div class="navGroupTitle">P≈ôehled</div>
          <a class="navItem" href="#dashboard" data-page="dashboard">
            <span class="ico">‚åÅ</span><span>Dashboard</span>
          </a>
          <a class="navItem" href="#schema" data-page="schema">
            <span class="ico">üó∫</span><span>Sch√©ma</span>
          </a>
        </div>

        <div class="navGroup">
          <div class="navGroupTitle">Funkce</div>
          <a class="navItem" href="#ekviterm" data-page="ekviterm">
            <span class="ico">üìà</span><span>Ekviterm</span>
          </a>
          <a class="navItem" href="#tuv" data-page="tuv">
            <span class="ico">‚ô®</span><span>Oh≈ôev TUV</span>
          </a>
          <a class="navItem" href="#recirc" data-page="recirc">
            <span class="ico">‚ü≥</span><span>Cirkulace TUV</span>
          </a>
          <a class="navItem" href="#aku" data-page="aku">
            <span class="ico">‚õÅ</span><span>Podpora AKU</span>
          </a>
          <a class="navItem" href="#aku_heater" data-page="aku_heater">
            <span class="ico">‚ö°</span><span>AKU heater</span>
          </a>
        </div>

        <div class="navGroup">
          <div class="navGroupTitle">Sd√≠len√© zdroje</div>
          <a class="navItem" href="#iofunc" data-page="iofunc">
            <span class="ico">‚éà</span><span>Funkce I/O</span>
          </a>
          <a class="navItem" href="#temps" data-page="temps">
            <span class="ico">üå°</span><span>Teplomƒõry</span>
          </a>
        </div>

        <div class="navGroup">
          <div class="navGroupTitle">Integrace</div>
          <a class="navItem" href="#mqtt" data-page="mqtt">
            <span class="ico">‚áÑ</span><span>MQTT / HA</span>
          </a>
          <a class="navItem" href="#ble" data-page="ble">
            <span class="ico">‚åÇ</span><span>BLE</span>
          </a>
        </div>

        <div class="navGroup">
          <div class="navGroupTitle">Syst√©m</div>
          <a class="navItem" href="#ota" data-page="ota">
            <span class="ico">‚§í</span><span>OTA</span>
          </a>
          <a class="navItem" href="#files" data-page="files">
            <span class="ico">‚ßâ</span><span>LittleFS</span>
          </a>
          <a class="navItem" href="#rules" data-page="rules">
            <span class="ico">‚ü∞</span><span>Rule engine</span>
          </a>
          <a class="navItem" href="#system" data-page="system">
            <span class="ico">‚ü≤</span><span>S√≠≈• / ƒças / syst√©m</span>
          </a>
        </div>
      </nav>

      <div class="sideFooter">
        <div class="chips">
          <span class="chip" id="chipWifi">Wi‚ÄëFi: ‚Äî</span>
          <span class="chip" id="chipMqtt">MQTT: ‚Äî</span>
        </div>
        <button class="ghost" id="btnTheme" title="P≈ôepnout motiv">Motiv</button>
      </div>
    </aside>

    <main class="main">
      <header class="topbar">
        <div class="topLeft">
          <button class="iconBtn" id="btnNav" type="button" aria-label="Menu">‚ò∞</button>
          <div>
            <div class="h1">≈ò√≠dic√≠ panel</div>
            <div class="muted" id="topHint">Naƒç√≠t√°m‚Ä¶</div>
          </div>
        </div>
        <div class="topRight">
          <div class="pill" id="pillIp">IP: ‚Äî</div>
          <div class="pill" id="pillUptime">uptime: ‚Äî</div>
        </div>
      </header>

      <div id="view"></div>
    </main>
  </div>

  <div id="toasts" class="toasts" aria-live="polite" aria-atomic="true"></div>
  <div id="modalRoot">
    <div class="modal hidden" id="ruleModal">
      <div class="modalBack" data-close="1"></div>
      <div class="modalCard">
        <div class="modalHead">
          <div>
            <div class="cardTitle" id="ruleModalTitle">Pravidlo</div>
            <div class="muted">Z√°kladn√≠ editor pro nejƒçastƒõj≈°√≠ sc√©n√°≈ôe</div>
          </div>
          <button class="btn ghost" id="btnRuleClose">Zav≈ô√≠t</button>
        </div>

        <div class="form">
          <div class="row">
            <div class="field"><label>N√°zev</label><input id="ruleName" /></div>
            <div class="field"><label>Popis</label><input id="ruleDesc" /></div>
          </div>

          <div class="row">
            <div class="field"><label>Enabled</label><select id="ruleEnabled"><option value="true">true</option><option value="false">false</option></select></div>
            <div class="field"><label>Priority</label><input id="rulePriority" type="number" step="1" /></div>
            <div class="field"><label>Stop on match</label><select id="ruleStopOnMatch"><option value="false">false</option><option value="true">true</option></select></div>
          </div>

          <div class="row">
            <div class="field"><label>Debounce (ms)</label><input id="ruleDebounceMs" type="number" step="10" min="0" /></div>
            <div class="field"><label>Min ON (ms)</label><input id="ruleMinOnMs" type="number" step="100" min="0" /></div>
            <div class="field"><label>Min OFF (ms)</label><input id="ruleMinOffMs" type="number" step="100" min="0" /></div>
          </div>

          <hr class="sep" />

          <div class="row">
            <div class="field">
              <label>WHEN (Podm√≠nky)</label>

              <div class="row" style="padding:0">
                <div class="field">
                  <label>Oper√°tor</label>
                  <select id="ruleWhenOp">
                    <option value="AND">AND</option>
                    <option value="OR">OR</option>
                  </select>
                </div>
                <div class="field" style="display:flex;align-items:flex-end">
                  <button class="btn" id="btnRuleAddCond">+ Podm√≠nka</button>
                </div>
              </div>

              <div id="ruleWhenList" class="kv" style="gap:10px"></div>
              <div class="note">Podporovan√© typy: Input, Time (HH:MM), MQTT (topic + hodnota). Kombinace p≈ôes AND/OR.</div>
            </div>
          </div>

          <div class="row">
            <div class="field">
              <label>THEN (Akce)</label>

              <div class="row" style="padding:0">
                <div class="field" style="display:flex;align-items:flex-end">
                  <button class="btn" id="btnRuleAddAction">+ Akce</button>
                </div>
              </div>

              <div id="ruleThenList" class="kv" style="gap:10px"></div>
              <div class="note">Podporovan√© akce: Relay set. Ostatn√≠ typy jsou p≈ôipraven√© v JSON (pulse / mqtt_publish).</div>
            </div>
          </div>

          <div class="btnRow" style="padding: 0 14px 14px">
            <button class="btn" id="btnRuleSave">Ulo≈æit do editoru</button>
            <button class="btn bad" id="btnRuleDelete">Smazat</button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal hidden" id="modalDays" aria-hidden="true">
      <div class="modalBack" data-close="1"></div>
      <div class="modalCard" style="width:min(520px, calc(100vw - 32px))">
        <div class="modalHead">
          <div>
            <div class="cardTitle">V√Ωbƒõr dn≈Ø</div>
            <div class="muted">Klikni na dny, kter√© maj√≠ b√Ωt aktivn√≠ (Po=1 .. Ne=7)</div>
          </div>
          <div class="actions">
            <button class="btn ghost" id="daysClose">Zav≈ô√≠t</button>
          </div>
        </div>
        <div class="pad">
          <div class="rtabs" style="flex-wrap:wrap">
            <button class="rtab" id="daysAll">V≈°e</button>
            <button class="rtab" id="daysWeek">Po‚ÄìP√°</button>
            <button class="rtab" id="daysWeekend">So‚ÄìNe</button>
            <button class="rtab" id="daysNone">Nic</button>
          </div>

          <div class="grid2" style="grid-template-columns:repeat(7,1fr); gap:10px; margin-top:10px">
            <label class="check" style="justify-content:center"><input type="checkbox" data-day="1"> <span>Po</span></label>
            <label class="check" style="justify-content:center"><input type="checkbox" data-day="2"> <span>√öt</span></label>
            <label class="check" style="justify-content:center"><input type="checkbox" data-day="3"> <span>St</span></label>
            <label class="check" style="justify-content:center"><input type="checkbox" data-day="4"> <span>ƒåt</span></label>
            <label class="check" style="justify-content:center"><input type="checkbox" data-day="5"> <span>P√°</span></label>
            <label class="check" style="justify-content:center"><input type="checkbox" data-day="6"> <span>So</span></label>
            <label class="check" style="justify-content:center"><input type="checkbox" data-day="7"> <span>Ne</span></label>
          </div>

          <div class="hr"></div>
          <div class="actions" style="justify-content:flex-end">
            <button class="btn ghost" id="daysCancel">Zru≈°it</button>
            <button class="btn" id="daysOk">Pou≈æ√≠t</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="/js/core/dom.js?v=1"></script>
  <script src="/js/core/util.js?v=1"></script>
  <script src="/js/core/events.js?v=1"></script>
  <script src="/js/core/store.js?v=1"></script>
  <script src="/js/core/api.js?v=1"></script>
  <script src="/js/core/toast.js?v=1"></script>
  <script src="/js/core/roles.js?v=1"></script>
  <script src="/js/core/dirty.js?v=1"></script>
  <script src="/js/core/configShape.js?v=1"></script>
  <script src="/js/core/polling.js?v=1"></script>
  <script src="/js/core/router.js?v=1"></script>
  <script src="/js/core/ui.js?v=1"></script>
  <script src="/js/core/opentherm.js?v=1"></script>
  <script src="/js/core/buzzer.js?v=1"></script>
  <script src="/js/core/valve_calib.js?v=1"></script>
  <script src="/js/core/time_ntp.js?v=1"></script>
  <script src="/js/core/schedules.js?v=1"></script>
  <script src="/js/core/schematic.templates.js?v=1"></script>
  <script src="/js/core/schematic.paths.js?v=1"></script>
  <script src="/js/core/schematic.router.js?v=1"></script>
  <script src="/js/core/schematic.main.js?v=1"></script>
  <script src="/js/core/schematic.js?v=1"></script>
  <script src="/js/pages/dashboard.js?v=1"></script>
  <script src="/js/pages/schema.js?v=1"></script>
  <script src="/js/pages/ekviterm.js?v=1"></script>
  <script src="/js/pages/tuv.js?v=1"></script>
  <script src="/js/pages/recirc.js?v=1"></script>
  <script src="/js/pages/aku.js?v=1"></script>
  <script src="/js/pages/aku_heater.js?v=1"></script>
  <script src="/js/pages/iofunc.js?v=1"></script>
  <script src="/js/pages/temps.js?v=1"></script>
  <script src="/js/pages/mqtt.js?v=1"></script>
  <script src="/js/pages/ble.js?v=1"></script>
  <script src="/js/pages/system.js?v=1"></script>
  <script src="/js/pages/ota.js?v=1"></script>
  <script src="/js/pages/files.js?v=1"></script>
  <script src="/js/pages/rules.js?v=1"></script>
  <script src="/js/core/legacy.js?v=2"></script>
  <script src="/js/app.js?v=2"></script>
</body>
</html>
